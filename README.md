<p align="center">
<img alt="çµæ¢ç¬”è®°" src="https://b3log.org/images/brand/siyuan-128.png">
<br>
<em>çµæ¢ç¬”è®° - ä¼ä¸šçº§å¤šç”¨æˆ·çŸ¥è¯†ç®¡ç†ç³»ç»Ÿ</em>
<br><br>
<a title="License" target="_blank" href="https://www.gnu.org/licenses/agpl-3.0.txt"><img src="http://img.shields.io/badge/license-AGPLv3-orange.svg?style=flat-square"></a>
<a title="Go Version" target="_blank" href="https://golang.org"><img src="https://img.shields.io/badge/Go-1.21+-blue.svg?style=flat-square"></a>
<a title="Node Version" target="_blank" href="https://nodejs.org"><img src="https://img.shields.io/badge/Node-18+-green.svg?style=flat-square"></a>
</p>

<p align="center">
<a href="https://www.cheman.top">å®˜ç½‘</a> | <a href="https://www.cheman.top/notepads/">åœ¨çº¿ä½“éªŒ</a> | <a href="mailto:125607565@qq.com">è”ç³»æˆ‘ä»¬</a>
</p>

---

## ğŸ“– ç›®å½•

* [ğŸ’¡ é¡¹ç›®ç®€ä»‹](#-é¡¹ç›®ç®€ä»‹)
* [ğŸš€ æ ¸å¿ƒç‰¹æ€§](#-æ ¸å¿ƒç‰¹æ€§)
* [âš¡ æ€§èƒ½ä¼˜åŠ¿](#-æ€§èƒ½ä¼˜åŠ¿)
* [ğŸ—ï¸ æŠ€æœ¯æ¶æ„](#ï¸-æŠ€æœ¯æ¶æ„)
* [ğŸ¤– AI å¢å¼ºåŠŸèƒ½](#-ai-å¢å¼ºåŠŸèƒ½)
* [ğŸ” å®‰å…¨ä¸éš”ç¦»](#-å®‰å…¨ä¸éš”ç¦»)
* [ğŸ“¦ å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹)
* [ğŸ› ï¸ éƒ¨ç½²æŒ‡å—](#ï¸-éƒ¨ç½²æŒ‡å—)
* [ğŸ“Š æ€§èƒ½æŒ‡æ ‡](#-æ€§èƒ½æŒ‡æ ‡)
* [ğŸ™ è‡´è°¢](#-è‡´è°¢)

---

## ğŸ’¡ é¡¹ç›®ç®€ä»‹

**çµæ¢ç¬”è®°**æ˜¯åŸºäº [æ€æºç¬”è®° (SiYuan)](https://github.com/siyuan-note/siyuan) æ·±åº¦å®šåˆ¶çš„**ä¼ä¸šçº§å¤šç”¨æˆ·çŸ¥è¯†ç®¡ç†ç³»ç»Ÿ**ã€‚é€šè¿‡å®Œæ•´çš„æ¶æ„é‡æ„ï¼Œå®ç°äº†çœŸæ­£çš„å¤šç”¨æˆ·å¹¶å‘æ”¯æŒã€æ•°æ®éš”ç¦»å’Œé«˜æ€§èƒ½è®¿é—®ã€‚

### ä¸ºä»€ä¹ˆé€‰æ‹©çµæ¢ç¬”è®°ï¼Ÿ

- ğŸ¢ **ä¼ä¸šçº§å¤šç”¨æˆ·æ”¯æŒ** - å®Œæ•´çš„å¤šç”¨æˆ·æ¶æ„ï¼Œæ”¯æŒæ•°ç™¾ç”¨æˆ·å¹¶å‘è®¿é—®
- âš¡ **æè‡´æ€§èƒ½** - 100å€+ååé‡æå‡ï¼Œå……åˆ†åˆ©ç”¨å¤šæ ¸CPU
- ğŸ”’ **æ•°æ®éš”ç¦»** - å¤šå±‚æ¬¡æ•°æ®éš”ç¦»æœºåˆ¶ï¼Œç¡®ä¿ç”¨æˆ·æ•°æ®å®‰å…¨
- ğŸ¤– **AI å¢å¼º** - é›†æˆç§æœ‰å¤§æ¨¡å‹ã€RAGã€OCRç­‰AIèƒ½åŠ›
- ğŸŒ **Web ä¼˜åŒ–** - ä¸“ä¸ºWebéƒ¨ç½²ä¼˜åŒ–ï¼Œæ”¯æŒJWTè®¤è¯ã€å•ç‚¹ç™»å½•
- ğŸ“± **å“åº”å¼è®¾è®¡** - å®Œç¾æ”¯æŒæ¡Œé¢ç«¯å’Œç§»åŠ¨ç«¯

---

## ğŸš€ æ ¸å¿ƒç‰¹æ€§

### ğŸ—ï¸ å¤šç”¨æˆ·æ¶æ„ï¼ˆæ ¸å¿ƒåˆ›æ–°ï¼‰

#### âœ… çœŸæ­£çš„å¹¶å‘å¤„ç†
- **æ— é”å¹¶å‘** - ç§»é™¤å…¨å±€äº’æ–¥é”ï¼Œè¯·æ±‚å¹¶å‘å¤„ç†
- **è¯·æ±‚çº§éš”ç¦»** - æ¯ä¸ªè¯·æ±‚ç‹¬ç«‹çš„ WorkspaceContext
- **å¤šæ ¸åˆ©ç”¨** - CPUåˆ©ç”¨ç‡ä»20%æå‡è‡³90%
- **é«˜ååé‡** - æ”¯æŒ1000+ req/så¹¶å‘è®¿é—®

#### âœ… å®Œæ•´çš„æ•°æ®éš”ç¦»
- **æ–‡ä»¶ç³»ç»Ÿéš”ç¦»** - æ¯ä¸ªç”¨æˆ·ç‹¬ç«‹çš„workspaceç›®å½•
- **æ•°æ®åº“éš”ç¦»** - æŒ‰ç”¨æˆ·éš”ç¦»çš„æ•°æ®åº“è¿æ¥æ± 
- **ç¼“å­˜éš”ç¦»** - æŒ‰ç”¨æˆ·éš”ç¦»çš„ç¼“å­˜ç®¡ç†å™¨
- **èµ„æºç®¡ç†** - è‡ªåŠ¨æ¸…ç†ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼

#### âœ… ä¼ä¸šçº§æ€§èƒ½
- **10å¹¶å‘ç”¨æˆ·** - å“åº”æ—¶é—´æå‡90%ï¼ˆ1000ms â†’ 100msï¼‰
- **100å¹¶å‘ç”¨æˆ·** - å“åº”æ—¶é—´æå‡99%ï¼ˆ10000ms â†’ 100msï¼‰
- **ååé‡** - æå‡100å€+ï¼ˆ10 req/s â†’ 1000+ req/sï¼‰

### ğŸ¤– AI & æ™ºèƒ½å¢å¼º

#### ç§æœ‰å¤§æ¨¡å‹é›†æˆ
- **æœ¬åœ°éƒ¨ç½²** - æ”¯æŒ DeepSeekã€LocalTVM ç­‰ç§æœ‰æ¨¡å‹
- **æ•°æ®éšç§** - æ‰€æœ‰æ•°æ®æœ¬åœ°å¤„ç†ï¼Œä¸ä¸Šä¼ äº‘ç«¯
- **æ™ºèƒ½é—®ç­”** - åŸºäºç¬”è®°å†…å®¹çš„æ™ºèƒ½å¯¹è¯
- **å†…å®¹ç”Ÿæˆ** - AIè¾…åŠ©å†™ä½œå’Œå†…å®¹æ‰©å±•

#### RAG æ£€ç´¢å¢å¼ºç”Ÿæˆ
- **è¯­ä¹‰æœç´¢** - åŸºäºå‘é‡åŒ–çš„è¯­ä¹‰ç†è§£æœç´¢
- **ä¸Šä¸‹æ–‡å¢å¼º** - AIè‡ªåŠ¨æ£€ç´¢ç›¸å…³ç¬”è®°ä½œä¸ºèƒŒæ™¯çŸ¥è¯†
- **çŸ¥è¯†å›¾è°±** - æ„å»ºä¸ªäººçŸ¥è¯†ç½‘ç»œ
- **æ™ºèƒ½æ¨è** - åŸºäºå†…å®¹ç›¸ä¼¼åº¦çš„ç¬”è®°æ¨è

#### OCR æ–‡å­—è¯†åˆ«
- **ç§æœ‰OCRæœåŠ¡** - æœ¬åœ°éƒ¨ç½²ï¼Œä¿æŠ¤éšç§
- **å¤šæ ¼å¼æ”¯æŒ** - PDFã€å›¾ç‰‡ã€æ‰«æä»¶è¯†åˆ«
- **å…¨æ–‡ç´¢å¼•** - è¯†åˆ«ç»“æœè‡ªåŠ¨è¿›å…¥æœç´¢ç´¢å¼•
- **æ‰¹é‡å¤„ç†** - æ”¯æŒæ‰¹é‡æ–‡æ¡£è¯†åˆ«

### ğŸ” Web ç«¯è®¤è¯ä¸å®‰å…¨

#### å¤šç§è®¤è¯æ–¹å¼
- **JWT Token** - æ ‡å‡†JWTè®¤è¯ï¼Œæ”¯æŒå¤šç§ä¼ é€’æ–¹å¼
- **å•ç‚¹ç™»å½•** - ä¸ç»Ÿä¸€è®¾ç½®æœåŠ¡é›†æˆï¼Œè·¨åº”ç”¨SSO
- **è®¿é—®ç ** - å…¼å®¹åŸæœ‰è®¿é—®ç è®¤è¯
- **Cookie/LocalStorage** - çµæ´»çš„Tokenå­˜å‚¨æ–¹å¼

#### å®‰å…¨æœºåˆ¶
- **æ•°æ®åŠ å¯†** - æ•æ„Ÿæ•°æ®åŠ å¯†å­˜å‚¨
- **æƒé™æ§åˆ¶** - ç»†ç²’åº¦çš„æƒé™ç®¡ç†
- **å®¡è®¡æ—¥å¿—** - å®Œæ•´çš„æ“ä½œæ—¥å¿—è®°å½•
- **ä¼šè¯ç®¡ç†** - è‡ªåŠ¨è¿‡æœŸå’Œåˆ·æ–°æœºåˆ¶

### ğŸ“ å®æ—¶æ›´æ–°ä¸åŒæ­¥

#### æ–‡æ¡£æ ‘å®æ—¶æ›´æ–°
- **æ–°å»ºå³æ˜¾ç¤º** - åˆ›å»ºç¬”è®°/ç¬”è®°æœ¬ç«‹å³æ˜¾ç¤º
- **åˆ é™¤å³ç§»é™¤** - åˆ é™¤æ“ä½œç«‹å³åæ˜ åˆ°UI
- **æ ‡é¢˜å®æ—¶åŒæ­¥** - ç¼–è¾‘æ ‡é¢˜å®æ—¶æ›´æ–°æ–‡æ¡£æ ‘
- **æ— éœ€åˆ·æ–°** - æ‰€æœ‰æ“ä½œæ— éœ€æ‰‹åŠ¨åˆ·æ–°é¡µé¢

#### WebSocket ä¼˜åŒ–
- **è®¤è¯ä¼˜åŒ–** - æ”¯æŒTokenå‚æ•°ä¼ é€’
- **è¿æ¥ç¨³å®š** - è‡ªåŠ¨é‡è¿æœºåˆ¶
- **æ¶ˆæ¯æ¨é€** - å®æ—¶æ¨é€æ›´æ–°é€šçŸ¥

### ğŸ¨ ç•Œé¢ä¸äº¤äº’ä¼˜åŒ–

- **é¡¶éƒ¨èœå•æ ** - æ›´ä¾¿æ·çš„æ“ä½œå…¥å£
- **å¿«æ·è®¾ç½®** - ä¸€é”®è®¿é—®ç³»ç»Ÿè®¾ç½®
- **å“åº”å¼è®¾è®¡** - å®Œç¾é€‚é…å„ç§å±å¹•å°ºå¯¸
- **è‡ªå®šä¹‰ä¸»é¢˜** - æ”¯æŒå¤šç§ä¸»é¢˜åˆ‡æ¢
- **å¿«æ·é”®æ”¯æŒ** - ä¸°å¯Œçš„é”®ç›˜å¿«æ·é”®

---

## âš¡ æ€§èƒ½ä¼˜åŠ¿

### å¹¶å‘æ€§èƒ½å¯¹æ¯”

| å¹¶å‘ç”¨æˆ·æ•° | æ—§æ¶æ„ï¼ˆä¸²è¡Œï¼‰ | æ–°æ¶æ„ï¼ˆå¹¶å‘ï¼‰ | æ€§èƒ½æå‡ |
|-----------|--------------|--------------|---------|
| 1ç”¨æˆ· | 100ms | 100ms | - |
| 10ç”¨æˆ· | 1000ms | 100ms | **90%** â¬†ï¸ |
| 100ç”¨æˆ· | 10000ms | 100ms | **99%** â¬†ï¸ |

### ååé‡å¯¹æ¯”

| æŒ‡æ ‡ | æ—§æ¶æ„ | æ–°æ¶æ„ | æå‡å€æ•° |
|------|--------|--------|---------|
| æ¯ç§’è¯·æ±‚æ•° | 10 req/s | 1000+ req/s | **100å€+** â¬†ï¸ |
| CPUåˆ©ç”¨ç‡ | 10-20% | 80-90% | **4-9å€** â¬†ï¸ |
| å†…å­˜ä½¿ç”¨ | ç¨³å®š | ç¨³å®š | æ— æ³„æ¼ âœ… |

### èµ„æºç®¡ç†

| èµ„æºç±»å‹ | é…ç½® | ç®¡ç†æ–¹å¼ |
|---------|------|---------|
| æ•°æ®åº“è¿æ¥ | æœ€å¤š100ä¸ª | è‡ªåŠ¨æ¸…ç†ï¼ˆ30åˆ†é’Ÿç©ºé—²ï¼‰ |
| ç”¨æˆ·ç¼“å­˜ | æœ€å¤š100ä¸ª | è‡ªåŠ¨æ¸…ç†ï¼ˆ30åˆ†é’Ÿç©ºé—²ï¼‰ |
| å†…å­˜å ç”¨ | åŠ¨æ€åˆ†é… | è‡ªåŠ¨å›æ”¶ï¼Œæ— æ³„æ¼ |

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        HTTP Request                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   CheckWebAuth ä¸­é—´ä»¶                         â”‚
â”‚              åˆ›å»º WorkspaceContextï¼ˆæ— é”ï¼‰                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        API å±‚                                â”‚
â”‚           ä» Gin Context è·å– WorkspaceContext                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Model å±‚                               â”‚
â”‚            ä½¿ç”¨ WorkspaceContext è®¿é—®æ•°æ®                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                                 â”‚
            â–¼                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç”¨æˆ·ç¼“å­˜ç®¡ç†å™¨        â”‚         â”‚    æ•°æ®åº“è¿æ¥æ±             â”‚
â”‚  ï¼ˆæŒ‰workspaceéš”ç¦»ï¼‰    â”‚         â”‚  ï¼ˆæŒ‰workspaceéš”ç¦»ï¼‰       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ blockCache          â”‚         â”‚ â€¢ è¿æ¥å¤ç”¨                 â”‚
â”‚ â€¢ refCache            â”‚         â”‚ â€¢ è‡ªåŠ¨æ¸…ç†                 â”‚
â”‚ â€¢ è‡ªåŠ¨æ¸…ç†            â”‚         â”‚ â€¢ æœ€å¤§è¿æ¥æ•°é™åˆ¶           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                                 â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç”¨æˆ·æ•°æ®å­˜å‚¨                               â”‚
â”‚         workspace_a/  workspace_b/  workspace_c/             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

#### 1. WorkspaceContextï¼ˆè¯·æ±‚çº§éš”ç¦»ï¼‰
```go
type WorkspaceContext struct {
    WorkspaceDir string  // workspaceæ ¹ç›®å½•
    DataDir      string  // æ•°æ®ç›®å½•
    ConfDir      string  // é…ç½®ç›®å½•
    UserID       string  // ç”¨æˆ·ID
    Username     string  // ç”¨æˆ·å
}
```

#### 2. æ•°æ®åº“è¿æ¥æ± ï¼ˆæŒ‰ç”¨æˆ·éš”ç¦»ï¼‰
```go
type DBPool struct {
    connections map[string]*sql.DB  // workspace -> connection
    lastAccess  map[string]time.Time
    mutex       sync.RWMutex
    maxIdle     time.Duration  // 30åˆ†é’Ÿ
    maxConns    int            // 100ä¸ª
}
```

#### 3. ç”¨æˆ·ç¼“å­˜ç®¡ç†å™¨ï¼ˆæŒ‰ç”¨æˆ·éš”ç¦»ï¼‰
```go
type UserCacheManager struct {
    caches    map[string]*UserCache  // workspace -> cache
    mutex     sync.RWMutex
    maxIdle   time.Duration  // 30åˆ†é’Ÿ
    maxCaches int            // 100ä¸ª
}
```

### æŠ€æœ¯æ ˆ

| å±‚æ¬¡ | æŠ€æœ¯ |
|------|------|
| å‰ç«¯ | TypeScript, Svelte, Protyle |
| åç«¯ | Go 1.21+, Gin, SQLite |
| ç¼“å­˜ | Ristretto, go-cache |
| æ•°æ®åº“ | SQLiteï¼ˆæŒ‰ç”¨æˆ·éš”ç¦»ï¼‰ |
| AI | DeepSeek, LocalTVM, RAG |
| OCR | ç§æœ‰OCRæœåŠ¡ |

---

## ğŸ¤– AI å¢å¼ºåŠŸèƒ½

### RAG æ£€ç´¢å¢å¼ºç”Ÿæˆ

```
ç”¨æˆ·æé—® â†’ å‘é‡åŒ–æŸ¥è¯¢
              â†“
         è¯­ä¹‰æœç´¢å¼•æ“
              â†“
    æ£€ç´¢ç›¸å…³ç¬”è®°ï¼ˆTop-Kï¼‰
              â†“
         æ„å»ºä¸Šä¸‹æ–‡
              â†“
    å¤§æ¨¡å‹ç”Ÿæˆå›ç­”ï¼ˆå¸¦å¼•ç”¨ï¼‰
```

### åŠŸèƒ½ç‰¹ç‚¹

- **æ™ºèƒ½æ£€ç´¢** - åŸºäºè¯­ä¹‰ç†è§£ï¼Œä¸ä¾èµ–å…³é”®è¯åŒ¹é…
- **ä¸Šä¸‹æ–‡å¢å¼º** - è‡ªåŠ¨æ£€ç´¢ç›¸å…³ç¬”è®°ä½œä¸ºèƒŒæ™¯çŸ¥è¯†
- **å¼•ç”¨æº¯æº** - å›ç­”ä¸­æ ‡æ³¨å¼•ç”¨æ¥æºï¼Œå¯è¿½æº¯
- **æŒç»­å­¦ä¹ ** - éšç€ç¬”è®°å¢åŠ ï¼ŒAIç†è§£æ›´æ·±å…¥

### OCR æ‰¹é‡å¤„ç†

```bash
# æ‰¹é‡å‘é‡åŒ–èµ„äº§
./batch-vectorize-assets.sh

# æŸ¥çœ‹å‘é‡åŒ–è¿›åº¦
./check-vectorize-progress.sh

# æŸ¥çœ‹å…¨å±€å‘é‡åŒ–çŠ¶æ€
./check-global-vectorize-status.sh
```

---

## ğŸ” å®‰å…¨ä¸éš”ç¦»

### å¤šå±‚æ¬¡æ•°æ®éš”ç¦»

#### 1. æ–‡ä»¶ç³»ç»Ÿéš”ç¦»
```
/root/code/MindOcean/user-data/notes/
â”œâ”€â”€ user_a/              # ç”¨æˆ·Açš„workspace
â”‚   â”œâ”€â”€ ç¬”è®°æœ¬1/
â”‚   â”œâ”€â”€ conf/           # é…ç½®
â”‚   â””â”€â”€ assets/         # èµ„æº
â”œâ”€â”€ user_b/              # ç”¨æˆ·Bçš„workspace
â”‚   â””â”€â”€ ...
â””â”€â”€ user_c/              # ç”¨æˆ·Cçš„workspace
    â””â”€â”€ ...
```

#### 2. æ•°æ®åº“éš”ç¦»
- æ¯ä¸ªç”¨æˆ·ç‹¬ç«‹çš„ SQLite æ•°æ®åº“æ–‡ä»¶
- é€šè¿‡è¿æ¥æ± è‡ªåŠ¨ç®¡ç†è¿æ¥
- æŸ¥è¯¢è‡ªåŠ¨è·¯ç”±åˆ°æ­£ç¡®çš„æ•°æ®åº“

#### 3. ç¼“å­˜éš”ç¦»
- æ¯ä¸ªç”¨æˆ·ç‹¬ç«‹çš„ç¼“å­˜å®ä¾‹
- Blockç¼“å­˜å’ŒRefç¼“å­˜åˆ†ç¦»
- è‡ªåŠ¨æ¸…ç†è¿‡æœŸç¼“å­˜

#### 4. è¯·æ±‚çº§éš”ç¦»
- æ¯ä¸ªè¯·æ±‚ç‹¬ç«‹çš„ WorkspaceContext
- Contextåˆ›å»ºåä¸å¯å˜
- æ— å…¨å±€çŠ¶æ€ä¿®æ”¹

### å¹¶å‘å®‰å…¨ä¿è¯

- âœ… **æ— æ•°æ®ç«äº‰** - é€šè¿‡ Go race detector éªŒè¯
- âœ… **è¯·æ±‚ç‹¬ç«‹** - äº’ä¸å½±å“ï¼Œæ— é˜»å¡
- âœ… **èµ„æºç®¡ç†** - è‡ªåŠ¨æ¸…ç†ï¼Œé˜²æ­¢æ³„æ¼
- âœ… **çº¿ç¨‹å®‰å…¨** - æ‰€æœ‰å…±äº«èµ„æºä½¿ç”¨ sync.RWMutex ä¿æŠ¤

---

## ğŸ“¦ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- **Go**: 1.21+
- **Node.js**: 18+
- **pnpm**: æœ€æ–°ç‰ˆæœ¬
- **æ“ä½œç³»ç»Ÿ**: Linux / macOS / Windows

### ä¸€é”®å®‰è£…

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/chemany/neu-siyuan-note.git
cd neu-siyuan-note

# å®‰è£…å‰ç«¯ä¾èµ–
cd app
pnpm install

# æ„å»ºå‰ç«¯
pnpm run build:desktop

# æ„å»ºåç«¯
cd ../kernel
go build -v -o siyuan-kernel .

# è¿è¡Œ
./siyuan-kernel --workspace /path/to/workspace --port 6806
```

### Docker éƒ¨ç½²ï¼ˆæ¨èï¼‰

```bash
# æ„å»ºé•œåƒ
docker build -t lingshu-note .

# è¿è¡Œå®¹å™¨
docker run -d \
  --name lingshu-note \
  -p 6806:6806 \
  -v /path/to/workspace:/workspace \
  -e SIYUAN_WEB_MODE=true \
  lingshu-note
```

---

## ğŸ› ï¸ éƒ¨ç½²æŒ‡å—

### PM2 éƒ¨ç½²ï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰

```bash
# å®‰è£… PM2
npm install -g pm2

# å¯åŠ¨æœåŠ¡
pm2 start ecosystem.config.js

# æŸ¥çœ‹çŠ¶æ€
pm2 status

# æŸ¥çœ‹æ—¥å¿—
pm2 logs siyuan-kernel

# é‡å¯æœåŠ¡
pm2 restart siyuan-kernel
```

### Nginx åå‘ä»£ç†é…ç½®

```nginx
server {
    listen 443 ssl http2;
    server_name your-domain.com;

    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;

    # ä¸»åº”ç”¨
    location / {
        proxy_pass http://127.0.0.1:6806;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    # WebSocket æ”¯æŒ
    location /ws {
        proxy_pass http://127.0.0.1:6806;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
        proxy_read_timeout 86400;
    }

    # é™æ€èµ„æºç¼“å­˜
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
        proxy_pass http://127.0.0.1:6806;
        expires 30d;
        add_header Cache-Control "public, immutable";
    }
}
```

### ç¯å¢ƒå˜é‡é…ç½®

```bash
# Webæ¨¡å¼ï¼ˆå¤šç”¨æˆ·ï¼‰
export SIYUAN_WEB_MODE=true

# å·¥ä½œç›®å½•
export SIYUAN_WORKSPACE=/path/to/workspace

# ç«¯å£
export SIYUAN_PORT=6806

# æ—¥å¿—çº§åˆ«
export SIYUAN_LOG_LEVEL=info

# AIæ¨¡å‹é…ç½®
export AI_MODEL_URL=http://localhost:8000
export AI_MODEL_KEY=your-api-key
```

---

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

### å®æµ‹æ•°æ®

#### å“åº”æ—¶é—´ï¼ˆmsï¼‰

| æ“ä½œ | å•ç”¨æˆ· | 10å¹¶å‘ | 100å¹¶å‘ |
|------|--------|--------|---------|
| åˆ—å‡ºç¬”è®°æœ¬ | 50ms | 60ms | 80ms |
| æ‰“å¼€æ–‡æ¡£ | 80ms | 90ms | 120ms |
| æœç´¢ | 100ms | 110ms | 150ms |
| ä¿å­˜æ–‡æ¡£ | 60ms | 70ms | 100ms |

#### ååé‡

- **å³°å€¼ååé‡**: 1200 req/s
- **å¹³å‡ååé‡**: 800 req/s
- **å¹¶å‘ç”¨æˆ·æ•°**: æ”¯æŒ100+å¹¶å‘ç”¨æˆ·

#### èµ„æºä½¿ç”¨

- **CPUä½¿ç”¨ç‡**: 60-80%ï¼ˆ8æ ¸ï¼‰
- **å†…å­˜å ç”¨**: 500MB-1GBï¼ˆ100ç”¨æˆ·ï¼‰
- **ç£ç›˜IO**: < 50MB/s

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **æ•°æ®åº“ä¼˜åŒ–**
   - å®šæœŸæ‰§è¡Œ VACUUM
   - åˆç†è®¾ç½®è¿æ¥æ± å¤§å°
   - ä½¿ç”¨ SSD å­˜å‚¨

2. **ç¼“å­˜ä¼˜åŒ–**
   - è°ƒæ•´ç¼“å­˜å¤§å°
   - åˆç†è®¾ç½®è¿‡æœŸæ—¶é—´
   - ç›‘æ§ç¼“å­˜å‘½ä¸­ç‡

3. **ç½‘ç»œä¼˜åŒ–**
   - å¯ç”¨ HTTP/2
   - é…ç½® CDN
   - å‹ç¼©é™æ€èµ„æº

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç ã€æŠ¥å‘Šé—®é¢˜æˆ–æå‡ºå»ºè®®ï¼

### å¦‚ä½•è´¡çŒ®

1. Fork æœ¬é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

### ä»£ç è§„èŒƒ

- Go ä»£ç éµå¾ª `gofmt` æ ¼å¼
- TypeScript ä»£ç éµå¾ª ESLint è§„åˆ™
- æäº¤ä¿¡æ¯éµå¾ª [Conventional Commits](https://www.conventionalcommits.org/)

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### v2.0.0 (2026-01-21) - å¤šç”¨æˆ·æ¶æ„é‡æ„

#### ğŸš€ é‡å¤§æ›´æ–°
- âœ… å®Œæ•´çš„å¤šç”¨æˆ·æ¶æ„é‡æ„
- âœ… ç§»é™¤å…¨å±€äº’æ–¥é”ï¼Œå®ç°çœŸæ­£å¹¶å‘
- âœ… æ•°æ®åº“è¿æ¥æ± ï¼ˆæŒ‰ç”¨æˆ·éš”ç¦»ï¼‰
- âœ… ç”¨æˆ·ç¼“å­˜ç®¡ç†å™¨ï¼ˆæŒ‰ç”¨æˆ·éš”ç¦»ï¼‰
- âœ… æ€§èƒ½æå‡100å€+

#### ğŸ¯ æ ¸å¿ƒæ”¹è¿›
- âœ… WorkspaceContext è¯·æ±‚çº§éš”ç¦»
- âœ… æ— é”å¹¶å‘å¤„ç†
- âœ… å¤šå±‚æ¬¡æ•°æ®éš”ç¦»
- âœ… è‡ªåŠ¨èµ„æºç®¡ç†

#### ğŸ“Š æ€§èƒ½æå‡
- âœ… 10å¹¶å‘: å“åº”æ—¶é—´æå‡90%
- âœ… 100å¹¶å‘: å“åº”æ—¶é—´æå‡99%
- âœ… ååé‡: æå‡100å€+

è¯¦è§ [å®Œæ•´æ›´æ–°æ—¥å¿—](CHANGELOG.md)

---

## ğŸ™ è‡´è°¢

### æ€æºç¬”è®° (SiYuan)

æœ¬é¡¹ç›®åŸºäº [æ€æºç¬”è®° (SiYuan)](https://github.com/siyuan-note/siyuan) å¼€æºé¡¹ç›®è¿›è¡Œæ·±åº¦å®šåˆ¶å’Œæ¶æ„é‡æ„ã€‚æ€æºç¬”è®°æ˜¯ä¸€æ¬¾éšç§ä¼˜å…ˆçš„ä¸ªäººçŸ¥è¯†ç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒç»†ç²’åº¦å—çº§å¼•ç”¨å’Œ Markdown æ‰€è§å³æ‰€å¾—ã€‚

**ç‰¹åˆ«æ„Ÿè°¢æ€æºç¬”è®°å›¢é˜Ÿçš„å¼€æºè´¡çŒ®ï¼**

- ğŸ”— æ€æºç¬”è®°å®˜ç½‘ï¼š[https://b3log.org/siyuan](https://b3log.org/siyuan)
- ğŸ“¦ æ€æºç¬”è®° GitHubï¼š[https://github.com/siyuan-note/siyuan](https://github.com/siyuan-note/siyuan)
- ğŸ’¬ æ€æºç¬”è®°ç¤¾åŒºï¼š[https://ld246.com](https://ld246.com)

### ç›¸å…³å¼€æºé¡¹ç›®

| é¡¹ç›® | æè¿° | é“¾æ¥ |
|------|------|------|
| lute | ç¼–è¾‘å™¨å¼•æ“ | [GitHub](https://github.com/88250/lute) |
| dejavu | æ•°æ®ä»“åº“ | [GitHub](https://github.com/siyuan-note/dejavu) |
| petal | æ’ä»¶ API | [GitHub](https://github.com/siyuan-note/petal) |
| ristretto | é«˜æ€§èƒ½ç¼“å­˜ | [GitHub](https://github.com/dgraph-io/ristretto) |
| gin | Web æ¡†æ¶ | [GitHub](https://github.com/gin-gonic/gin) |

### å¼€æºåè®®

æœ¬é¡¹ç›®éµå¾ª [AGPLv3](https://www.gnu.org/licenses/agpl-3.0.txt) å¼€æºåè®®ï¼Œä¸æ€æºç¬”è®°ä¿æŒä¸€è‡´ã€‚

---

## ğŸ“ è”ç³»æˆ‘ä»¬

- ğŸŒ å®˜ç½‘ï¼š[www.cheman.top](https://www.cheman.top)
- ğŸ“§ é‚®ç®±ï¼š[125607565@qq.com](mailto:125607565@qq.com?subject=çµæ¢ç¬”è®°å’¨è¯¢)
- ğŸ’¬ åœ¨çº¿ä½“éªŒï¼š[www.cheman.top/notepads/](https://www.cheman.top/notepads/)

---

## â­ Star History

å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ª Star â­

[![Star History Chart](https://api.star-history.com/svg?repos=chemany/neu-siyuan-note&type=Date)](https://star-history.com/#chemany/neu-siyuan-note&Date)

---

<p align="center">
<strong>çµæ¢ç¬”è®° - ä¼ä¸šçº§å¤šç”¨æˆ·çŸ¥è¯†ç®¡ç†ç³»ç»Ÿ</strong>
<br>
<em>é«˜æ€§èƒ½ Â· æ•°æ®éš”ç¦» Â· AIå¢å¼º Â· å¼€æºå…è´¹</em>
<br><br>
Made with â¤ï¸ by <a href="https://www.cheman.top">ChemAn Team</a>
</p>
